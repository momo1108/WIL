# 칼리 리눅스

- 포트 스캐닝

  특정 포트가 동작하고 있는지 확인하는 것 (ex. 80번 포트가 돌고있는지 확인하면 웹 서버가 돌고있다라는걸 알 수 있다.)

  - 가장 기본적인 것

    TCP Open Scan - TCP 연결과정(3-way handshaking)을 통해서 해당 포트의 실행(사용) 여부를 확인

    - 해당 포트가 유효하면  SYN →,  SYN/ACK ←,  ACK →   = 연결(세션)이 수립 = 접속(연결) 로그가 남음

      로그가 남으면 추적이 가능하기 때문에 공격자에게 안좋다.

    - 해당 포트가 무효하면  SYN →,  RST/ACK ←

    Stealth Scan - 기록을 남기지 않는 포트 스캔 방법

    - TCP half open scan = TCP SYN open scan

      해당 포트가 유효하면 : SYN →,  SYNC/ACK ←,  (RST →)	= ACK가 와도 그냥 가만히 대기하거나 리셋(나는 동작사실을 확인할 수 있음) = 연결이 수립되지 않음 = 로그가 남지 않는다.

      해당 포트가 무효하면 : SYN →,  RST/ACK ←

    - FIN scan

      해당 포트가 유효하면 : FIN →,  ??? (무응답)

      해당 포트가 무효하면 : FIN →,  RST/ACK ←

    - XMAS scan

      해당 포트가 유효하면 : FIN+PSH+URG(흔치 않은 플래그를 보냄) →,  ??? (무응답)

      해당 포트가 무효하면 : FIN+PSH+URG →,  RST/ACK ←

    - NULL scan

      해당 포트가 유효하면 : NULL(플래그를 비움) →,  ??? (무응답)

      해당 포트가 무효하면 : NULL →,  RST/ACK ←



# 실습

nmap (network map)

- 네트워크에 연결되어 있는 호스트의 정보를 파악하는 도구
- nmap을 이용해서 네트워크에 연결되어 있는 호스트의 IP, OS, Service Port, SW 등을 확인할 수 있음

nmap --help

SCAN TECHNIQUES:

  -**sS/sT**/sA/sW/sM: **TCP SYN/Connect()**/ACK/Window/Maimon scans

  -sU: UDP Scan

  -**sN/sF/sX: TCP Null, FIN, and Xmas scans**

  --scanflags <flags>: Customize TCP scan flags

  -sI <zombie host[:probeport]>: Idle scan

  -sY/sZ: SCTP INIT/COOKIE-ECHO scans

  -sO: IP protocol scan

  -b <FTP relay host>: FTP bounce scan



**Kali #1에 apache2, vsftp 서비스를 실행**

\# service apache2 start

\# service vsftpd start

**Kali#2에서 Kali#1으로 웹 서비스 요청과 FTP 서비스 요청을 할 수 있음**

- 아파치 서버가 작동중인지 파이어폭스로 확인해본다.

![](/image/kali0.jpg)

- ftp 가 작동중인지 ftp 명령어로 확인해본다.
- Victom쪽에서 와이어 샤크를 실행시킨 뒤 Attacker 쪽에서 포트 스캔을 해본다.

![](/image/kali1.jpg)

![](/image/kali2.jpg)

- 포트 스캔 방식과 포트를 지정해줘서 스캔을 해본다.

![](/image/kali3.jpg)

- 그 결과를 와이어샤크를 이용해 캡쳐한다. (TCP half open scan)

![](/image/kali4.jpg)

- 그 결과를 와이어샤크를 이용해 캡쳐한다. (TCP open scan)

![](/image/kali5.jpg)

- NULL, FIN, XMAS scan을 해보고 캡쳐해본다.

![](/image/kali6.jpg)

